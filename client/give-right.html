<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Voting system</title>

    <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
    <link
        href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
        rel="stylesheet">

    <link href="css/sb-admin-2.min.css" rel="stylesheet">

</head>

<body id="page-top">
    


    <div id="wrapper">

        <ul class="navbar-nav bg-gradient-primary sidebar sidebar-dark accordion" id="accordionSidebar">

            <a class="sidebar-brand d-flex align-items-center justify-content-center" href="view-result.html">
                <div class="sidebar-brand-icon rotate-n-15">
                    <i class="fas fa-laugh-wink"></i>
                </div>
                <div class="sidebar-brand-text mx-3">Voting system</div>
            </a>

            <hr class="sidebar-divider my-0">

            <li class="nav-item">
                <a class="nav-link" href="view-result.html">
                    <i class="fas fa-fw fa-chart-area"></i>
                    <span>View Result</span></a>
            </li>

            <hr class="sidebar-divider">

            <div class="sidebar-heading">
                For Admin
            </div>

            <li class="nav-item">
                <a class="nav-link" href="add-proposal.html">
                    <i class="fas fa-fw fa-user"></i>
                    <span>Add Proposal</span></a>
            </li>

            <li class="nav-item active">
                <a class="nav-link" href="give-right.html">
                    <i class="fas fa-fw fa-wrench"></i>
                    <span>Give Right</span></a>
            </li>

            <hr class="sidebar-divider">

            <div class="sidebar-heading">
                Voter
            </div>

            <li class="nav-item">
                <a class="nav-link" href="vote.html">
                    <i class="fas fa-donate "></i>
                    <span>Vote</span></a>
            </li>

            <li class="nav-item">
                <a class="nav-link" href="delegate.html">
                    <i class="fas fa-fw fa-folder"></i>
                    <span>Delegate</span></a>
            </li>

            <!-- Divider -->
            <hr class="sidebar-divider d-none d-md-block">

        </ul>
        <!-- End of Sidebar -->

        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column">

            <!-- Main Content -->
            <div id="content">

                <!-- Begin Page Content -->
                <div class="container-fluid">

                    <!-- Page Heading -->
                    <div class="d-sm-flex align-items-center justify-content-between mb-4 mt-4">
                        <h1 class="h3 mb-0 text-gray-800">Give Right To Voter</h1>
                    </div>


                    <div class="card shadow mb-4">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">Give Right To Voter</h6>
                        </div>
                        <div class="card-body">
                            <div>
                                

                                <div class="form-group">
                                  <label for="voter-address">Voter address</label>
                                  <input type="text" class="form-control" id="voter-address" placeholder="Enter voter address">
                                  <label for="voter-name">Voter name</label>
                                  <input type="text" class="form-control" id="voter-name" placeholder="Enter Name">
                                  <label for="voter-age">Voter age</label>
                                  <input type="number" class="form-control" id="voter-age" placeholder="Enter Age">
                                  <label for="voter-card">Voter identity card</label>
                                  <input type="text" class="form-control" id="voter-card" placeholder="Enter identity card ">
                                  <label for="voter-province">Voter province</label>
                                  <select id="voter-province" class="form-control"  name= "flatform"  >
                                    <option value="An Giang">An Giang
                                    <option value="Bà Rịa - Vũng Tàu">Bà Rịa - Vũng Tàu
                                    <option value="Bắc Giang">Bắc Giang
                                    <option value="Bắc Kạn">Bắc Kạn
                                    <option value="Bạc Liêu">Bạc Liêu
                                    <option value="Bắc Ninh">Bắc Ninh
                                    <option value="Bến Tre">Bến Tre
                                    <option value="Bình Định">Bình Định
                                    <option value="Bình Dương">Bình Dương
                                    <option value="Bình Phước">Bình Phước
                                    <option value="Bình Thuận">Bình Thuận
                                    <option value="Bình Thuận">Bình Thuận
                                    <option value="Cà Mau">Cà Mau
                                    <option value="Cao Bằng">Cao Bằng
                                    <option value="Đắk Lắk">Đắk Lắk
                                    <option value="Đắk Nông">Đắk Nông
                                    <option value="Điện Biên">Điện Biên
                                    <option value="Đồng Nai">Đồng Nai
                                    <option value="Đồng Tháp">Đồng Tháp
                                    <option value="Đồng Tháp">Đồng Tháp
                                    <option value="Gia Lai">Gia Lai
                                    <option value="Hà Giang">Hà Giang
                                    <option value="Hà Nam">Hà Nam
                                    <option value="Hà Tĩnh">Hà Tĩnh
                                    <option value="Hải Dương">Hải Dương
                                    <option value="Hậu Giang">Hậu Giang
                                    <option value="Hòa Bình">Hòa Bình
                                    <option value="Hưng Yên">Hưng Yên
                                    <option value="Khánh Hòa">Khánh Hòa
                                    <option value="Kiên Giang">Kiên Giang
                                    <option value="Kon Tum">Kon Tum
                                    <option value="Lai Châu">Lai Châu
                                    <option value="Lâm Đồng">Lâm Đồng
                                    <option value="Lạng Sơn">Lạng Sơn
                                    <option value="Lào Cai">Lào Cai
                                    <option value="Long An">Long An
                                    <option value="Nam Định">Nam Định
                                    <option value="Nghệ An">Nghệ An
                                    <option value="Ninh Bình">Ninh Bình
                                    <option value="Ninh Thuận">Ninh Thuận
                                    <option value="Phú Thọ">Phú Thọ
                                    <option value="Quảng Bình">Quảng Bình
                                    <option value="Quảng Bình">Quảng Bình
                                    <option value="Quảng Ngãi">Quảng Ngãi
                                    <option value="Quảng Ninh">Quảng Ninh
                                    <option value="Quảng Trị">Quảng Trị
                                    <option value="Sóc Trăng">Sóc Trăng
                                    <option value="Sơn La">Sơn La
                                    <option value="Tây Ninh">Tây Ninh
                                    <option value="Thái Bình">Thái Bình
                                    <option value="Thái Nguyên">Thái Nguyên
                                    <option value="Thanh Hóa">Thanh Hóa
                                    <option value="Thừa Thiên Huế">Thừa Thiên Huế
                                    <option value="Tiền Giang">Tiền Giang
                                    <option value="Trà Vinh">Trà Vinh
                                    <option value="Tuyên Quang">Tuyên Quang
                                    <option value="Vĩnh Long">Vĩnh Long
                                    <option value="Vĩnh Phúc">Vĩnh Phúc
                                    <option value="Yên Bái">Yên Bái
                                    <option value="Phú Yên">Phú Yên
                                    <option value="Cần Thơ">Tp.Cần Thơ
                                    <option value="Đà Nẵng">Tp.Đà Nẵng
                                    <option value="Hải Phòng">Tp.Hải Phòng
                                    <option value="Hà Nội">Tp.Hà Nội
                                    <option value="HCM">TP HCM
                                    </select>
                                </div>
                            
                                <button class="btn btn-primary" onclick="giveRightToVoter()">Submit</button>
                            </div>
                        </div>

                    </div>
                    
                    <script>
                        
                        async function handleAddVoter(){
                            console.log("test");
                            const db = firebase.firestore()

                            const address = $('#voter-address').val();
                            const name = $('#voter-name').val();
                            const card = $('#voter-card').val();
                            const age = Number($('#voter-age').val());
                            const province = $('#voter-province').val();
                            db.collection("voters").add({
                                address : address,
                                age : age,
                                card : card,
                                name : name,
                                province : province
                            }).then(() => {
                                console.log("Data saved")
                            }).catch((error) => {
                                console.log(error)
                            })
                            
                        }
                        
                        window.addEventListener('load', (event) => {
                            console.log('The page has fully loaded');
                            initFirebase();
                        });

                        async function initFirebase(){
                            const firebaseConfig = {
                              apiKey: "AIzaSyBSF4DTIfBAs1B9OkVSmdSXKkx2FIGFpqU",
                              authDomain: "voting-system-94342.firebaseapp.com",
                              projectId: "voting-system-94342",
                              storageBucket: "voting-system-94342.appspot.com",
                              messagingSenderId: "390102264210",
                              appId: "1:390102264210:web:0a35051ec937ecc635f94b",
                              measurementId: "G-DJB7NYKSB4"
                            };
                          
                            // Initialize Firebase
                            const app = firebase.initializeApp(firebaseConfig);
                            const db = firebase.firestore();
                            console.log(app)

                        }
                         
                    </script>


                    <script>
                        async function giveRightToVoter(){
                            const address = $('#voter-address').val();
                            const name = $('#voter-name').val();
                            const card = $('#voter-card').val();
                            const age = Number($('#voter-age').val());
                            const province = $('#voter-province').val();

                            if (!address ) {
                                alert("Voter address is not empty");
                                return;
                            }else if(!name){
                                alert("Name-Voter address is not empty");
                                return;
                            }else if(!card) { 
                                alert("Identity-Voter address is not empty");
                                return;
                            }else if(!age || age <18){
                                alert("Age-Voter address is not illegal");
                                return;
                            }

                            const result = await Ballot.giveRightToVote(address);

                            alert(result.message);

                            const db = firebase.firestore()
                            // add data voters to firebase
                            if(result.success){ 
                            await db.collection("voters").add({
                                address : address,
                                age : age,
                                card : card,
                                name : name,
                                province : province
                            }).then(() => {
                                console.log("Data saved")
                            }).catch((error) => {
                                console.log(error)
                            })
                            window.location.reload();
                        }



                        }
                    </script>
                    
            </div>
            <!-- End of Main Content -->

        </div>
        <!-- End of Content Wrapper -->

    </div>
    <!-- End of Page Wrapper -->

    <!-- Scroll to Top Button-->
    <a class="scroll-to-top rounded" href="#page-top">
        <i class="fas fa-angle-up"></i>
    </a>

    

    <!-- Bootstrap core JavaScript-->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Core plugin JavaScript-->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- Custom scripts for all pages-->
    <script src="js/sb-admin-2.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    <script src="./js/ballot.js" type="text/javascript"></script>

    <!-- connect firebase -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js" ></script>
    


    
    
    
    
</body>

</html>